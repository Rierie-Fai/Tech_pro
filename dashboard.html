<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Dashboard | Hexindo Fleet</title>
    <link rel="manifest" href="./manifest.json">
    <link rel="preload" href="./assets/css/core-font.css" as="style">
    <link rel="preload" href="./assets/css/all.min.css" as="style">
    <link rel="preload" href="./assets/css/theme-engine.css" as="style">
    <link rel="preload" href="./assets/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>
    <style>
        /* Targetkan kontainer utama dashboard kamu (biasanya scaler-context) */
        #scaler-context.opacity-0 {
            opacity: 0 !important;
            pointer-events: none !important;
        }
    </style>
    <link href="./assets/css/core-font.css" rel="stylesheet">
    <link href="./assets/css/all.min.css" rel="stylesheet">
    <link href="./html/css/dashboard-theme.css?v=2" rel="stylesheet">
    
    <script src="./assets/js/tailwindcss.js"></script>
    <script src="./assets/js/supabase.js" defer></script>
    <script src="./html/js/dashboard.js" defer></script>
    <script src="./assets/js/theme-engine.js" defer></script>
    <script src="./assets/js/splash.js" ></script>
    
</head>

<body id="body-tema">

    <div id="bg-layer">
        <canvas id="mecha-canvas"></canvas>
        <canvas id="bubble-canvas" style="display:none;"></canvas>
    </div>
    <div id="drawerOverlay" class="fixed inset-0 bg-black/40 backdrop-blur-sm z-40 opacity-2 pointer-events-none transition-opacity duration-300" onclick="Dash.closeAllDrawers()"></div>

    <aside id="notifDrawer" class="drawer bg-white p-0 rounded-none border-y-0 border-r-0 border-l-2" style="margin-bottom: 0;">

        <div class="p-5 border-b border-black/10 flex justify-between items-center sticky top-0 z-10">
            <div>
                <h3 class="text-sm font-black uppercase tracking-wider warna-teks" style="font-family: var(--font-judul);"><i class="fas fa-bell mr-2 warna-aksen"></i>Notifications</h3>
            </div>
            <button onclick="Dash.closeAllDrawers()" class="w-8 h-8 rounded-full bg-red-100 text-red-500 flex items-center justify-center hover:scale-110 transition-transform"><i class="fas fa-times"></i></button>
        </div>
        <div id="notifList" class="flex-1 overflow-y-auto p-4 space-y-3"><div class="text-center py-10"><i class="fas fa-circle-notch fa-spin opacity-50 warna-teks"></i></div></div>
    </aside>

    <aside id="chatDrawer" class="drawer bg-white p-0 rounded-none border-y-0 border-l-0 border-r-2" style="margin-bottom: 0;">

        <div class="p-5 border-b border-black/10 flex justify-between items-center sticky top-0 z-10">
            <div class="flex items-center gap-3">
                <button id="btnBackToContacts" onclick="Dash.showContactList()" class="hidden w-8 h-8 rounded-full bg-black/5 flex items-center justify-center hover:scale-110 transition-transform"><i class="fas fa-arrow-left"></i></button>
                <div>
                    <h3 id="chatHeaderTitle" class="text-sm font-black uppercase tracking-wider warna-teks" style="font-family: var(--font-judul);">COMMS CENTER</h3>
                    <p id="chatHeaderSubtitle" class="text-[9px] font-bold uppercase opacity-50" style="font-family: var(--font-teks);">SELECT FREQUENCY</p>
                </div>
            </div>
            <button onclick="Dash.closeAllDrawers()" class="w-8 h-8 rounded-full bg-red-100 text-red-500 flex items-center justify-center hover:scale-110 transition-transform"><i class="fas fa-times"></i></button>
        </div>
        
        <div id="contactListView" class="flex-1 overflow-y-auto p-4 space-y-2">
            <div onclick="Dash.openChat('ALL')" class="p-4 border-2 border-blue-500 bg-blue-50 rounded-xl cursor-pointer hover:bg-blue-100 transition-all active:scale-[0.98]">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-xl bg-blue-200 text-blue-700 flex items-center justify-center text-xl"><i class="fas fa-globe"></i></div>
                    <div><h4 class="text-sm font-bold uppercase text-blue-900" style="font-family: var(--font-judul);">GLOBAL FREQUENCY</h4><p class="text-[10px] opacity-70 font-mono text-blue-800">BROADCAST TO ALL UNITS</p></div>
                </div>
            </div>
            <div class="mt-6 mb-3"><p class="text-[10px] font-bold uppercase opacity-50 pl-2 warna-teks">ACTIVE PERSONNEL</p></div>
            <div id="userListContainer" class="space-y-2"><div class="text-center py-4"><i class="fas fa-spinner fa-spin opacity-50 warna-teks"></i></div></div>
        </div>

        <div id="chatRoomView" class="hidden flex-1 flex flex-col bg-black/5 relative">
            <div id="chatMessages" class="flex-1 overflow-y-auto p-4 flex flex-col space-y-2 pb-20"></div>
            <div class="p-3 bg-white/80 backdrop-blur-md border-t border-black/10 absolute bottom-0 left-0 right-0">
                <form id="chatForm" class="flex gap-2 items-center" onsubmit="Dash.sendMessage(event)">
                    <input type="text" id="chatInput" class="flex-1 px-4 py-2 text-sm bg-white border-2 border-black/10 rounded-xl focus:outline-none focus:border-blue-500 transition-all text-black" placeholder="Transmitting..." autocomplete="off">
                    <button type="submit" class="w-10 h-10 bg-blue-600 text-white rounded-xl hover:bg-amber-500 transition-all flex items-center justify-center active:scale-90"><i class="fas fa-paper-plane"></i></button>
                </form>
            </div>
        </div>
    </aside>

    <div id="scaler-context" class="opacity-0">
        
        <div id="target-reticle">
            <div class="corner t-l"></div><div class="corner t-r"></div>
            <div class="corner b-l"></div><div class="corner b-r"></div>
            <div class="scan-label">TRACKING...</div>
        </div>

        <header class="scan-target kartu-utama header-portal">
            <div class="header-top">
                            <div class="brand-box relative">
                <button class="btn-icon" onclick="Dash.toggleDrawer('chatDrawer')">
                    <i class="fas fa-comment-dots"></i>
                    <span id="chatBadge" class="absolute top-0 right-0 w-3 h-3 bg-blue-500 rounded-full border-2 border-white hidden animate-bounce"></span>
                </button>
                <h1 class="judul-portal">HEXINDO <span>PORTAL</span></h1>

            </div>

            <div class="action-box relative">
                <button id="notifBtn" class="btn-icon hidden" onclick="Dash.toggleDrawer('notifDrawer')">
                    <i class="fas fa-bell"></i>
                    <span id="notifBadge" class="absolute top-0 right-0 w-3 h-3 bg-red-500 rounded-full border-2 border-white hidden"></span>
                </button>
                <a href="setting.html" class="btn-icon"><i class="fas fa-cog"></i></a>
                <button class="btn-icon btn-logout" onclick="Dash.logout()"><i class="fas fa-power-off"></i></button>
            </div>

            </div>
            <div class="header-bottom">
                <div class="user-info">
                    <p class="label-mini">USER NAME</p>
                    <p id="userNameDisplay" class="value-bold">LOADING...</p>
                </div>
                <div id="userNikDisplay" class="nik-badge">NIK: ------</div>
            </div>
        </header>

        <div class="scan-target kartu-utama clock-panel">
            <div class="status-bar">
                <span id="roleBadge" class="badge-role">LOADING...</span>
                <span id="liveDate" class="date-text">...</span>
            </div>
            <h3 id="liveTime" class="digital-clock">00:00:00</h3>
            <div class="marquee-container">
                <p class="marquee-text">SAFETY FIRST — AUTHORIZED PERSONNEL ONLY — SYSTEM ONLINE — ADARO PROJECT 2026 —</p>
            </div>
        </div>

        <div class="modul-grid">
            <a href="troubleshoot.html" class="scan-target kartu-utama menu-card" onclick="Dash.navigate(event, 'troubleshoot.html', 'DIAGNOSTIC', this)">
                <div class="menu-icon"><i class="fas fa-laptop-medical text-cyan-500"></i></div>
                <div class="menu-label">
                    <h3>DIAGNOSTIC</h3>
                    <p>Smart Troubleshoot</p>
                </div>
            </a>

            <a href="admin.html" id="modul-admin" class="scan-target kartu-utama menu-card hidden border-red-500/30" onclick="Dash.navigate(event, 'admin.html', 'SYS ADMIN', this)">
                <div class="menu-icon" style="color: #ef4444;"><i class="fas fa-user-shield"></i></div>
                <div class="menu-label">
                    <h3 style="color: #ef4444;">SYS ADMIN</h3>
                    <p>Control Center</p>
                </div>
            </a>
            
            <a href="activity.html" class="scan-target kartu-utama menu-card" onclick="Dash.navigate(event, 'activity.html', 'ACTIVITY', this)">
                <div class="menu-icon"><i class="fas fa-clipboard-check"></i></div>
                <div class="menu-label">
                    <h3>ACTIVITY</h3>
                    <p>Daily Log Report</p>
                </div>
            </a>
            <a href="uc.html" class="scan-target kartu-utama menu-card" onclick="Dash.navigate(event, 'uc.html', 'UNDERCARRIAGE', this)">
                <div class="menu-icon"><i class="fas fa-tractor"></i></div>
                <div class="menu-label">
                    <h3>UNDERCARRIAGE</h3>
                    <p>Inspection Tool</p>
                </div>
            </a>
            <a href="pump-tuning.html" class="scan-target kartu-utama menu-card" onclick="Dash.navigate(event, 'pump-tuning.html', 'HYDRAULIC', this)">
                <div class="menu-icon"><i class="fas fa-oil-can"></i></div>
                <div class="menu-label">
                    <h3>HYDRAULIC</h3>
                    <p>Pump Tuning</p>
                </div>
            </a>
            <a href="toolbox.html" class="scan-target kartu-utama menu-card" onclick="Dash.navigate(event, 'toolbox.html', 'TOOLBOX', this)">
                <div class="menu-icon"><i class="fas fa-toolbox"></i></div>
                <div class="menu-label">
                    <h3>TOOLBOX</h3>
                    <p>Checklist Pro</p>
                </div>
            </a>
        </div>

        <footer class="footer-bottom">
            <p>© 2026 HEXINDO ADARO PROJECT</p>
        </footer>
    </div>

    <div id="crosshair-target">
        <div class="garis-scan"></div>
    </div>
    <div id="mecha-layar-transisi" class="layar-transisi">
        <div class="teks-loading" id="mecha-teks-tujuan"></div>
    </div>

    <div id="mint-loader-overlay" class="layar-transisi">
        <div class="jelly-dots-container">
            <div class="dot"></div><div class="dot"></div><div class="dot"></div>
        </div>
        <div class="teks-loading-jelly" id="mint-teks-tujuan">Sedang menyiapkan...</div>
    </div>
    <script src="./assets/js/offline-manager.js" defer></script>

</body>
</html>
